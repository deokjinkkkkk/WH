<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/index}">


<body>

	<div layout:fragment="content" class="content">
		<!--좋아요 버튼 css-->
		<style>
a {
	text-decoration: none;
	color: inherit;
	cursor: pointer;
	
}

.right_area .icon {
	display: flex;
	align-items: center;
	justify-content: center;
	width: calc(100vw * ( 45/ 1920));
	height: calc(100vw * ( 45/ 1920));
	border-radius: 50%;
	border: solid 2px #eaeaea;
	background-color: #fff;
	
	
}

.icon.heart img {
	width: calc(100vw * ( 24/ 1920));
	height: calc(100vw * ( 24/ 1920));
}

.icon.heart.fas {
	color: red;
	position: absolute;
     left: 700px;
      top: 50px;
	
}

.heart {
	transform-origin: center;
	
	
}

.heart.active img {
	animation: animateHeart .3s linear forwards;
	
}

@keyframes animateHeart { 0%{
	transform: scale(.2);
	
}
40%
{
transform:scale(1.2);

}
100%
{
transform:scale(1);
}
}
#greatBtn{
position: absolute;
     left: 700px;
      top: 50px;
}


#tripBtn{
	position: absolute;
	left: 650px;
	top: 50px;
}
</style>
		<!--좋아요 버튼 css-종료-->

		<!-- 여행 코스 상세정보 -->
		<section>
			<div class="container">
				<div class="row">
					<div class="col-lg-8 col-md-12 sm-margin-40px-bottom xs-margin-35px-bottom blogs">
						<div class="posts">

									<!-- 작성자 프로필 시작 -->								
									 <div class="author-thumb">
                                        <img src="img/blog/01.png" class="rounded-circle width-5 xs-width-5" alt="" />
                                    </div>
                                    <div class="comment-info">
                                        <h6><a href="javascript:void(0);">쫜덕</a></h6>
                                        </div>
                                    <!-- 작성자 프로필 끝 -->
                                     <!--좋아요 버튼 기능html-->
											<div class="right_area" id="greatBtn">
												<button type="button" class="icon heart">
													<img
															src="https://cdn-icons-png.flaticon.com/512/812/812327.png"
															id="greatImg"> 
												</button>
													<input type="hidden" id="id" name="id"
														th:value="${session.name}">
											</div>
											<!--좋아요 버튼 기능html 종료-->
						
							<!-- post 시작 -->
							<div class="post">
								<div class="content">
									<div class="blog-list-simple-text post-meta margin-20px-bottom">
									
                                    
										<div class="post-title-g margin-20px-bottom text-center">
											<h5 th:text="${onecourse.couName}"></h5>
											<p th:text="${onecourse.couContent}" class="margin-30px-bottom"></p>
										</div>
										
										<!-- 코스 종류 사진(옆으로 넘어감, 클릭 시 코스에 대한 상세설명과 관련 사진 출력) -->
                              			<!-- 사진 클릭 이벤트 걸려면 이 덩어리에 id 걸어줘야 함 -->
                                        <div class="owl-carousel owl-theme tour">
                                            <div th:each="c : ${course}">
                                            	<a th:href="@{/tripDetail/{tripCode}(tripCode=${c.tripCode})}">
                                                <img th:src="${c.imgGroCode}"  class="border-radius-4" style="width:500; height:300px;"/>
                                           		</a>
                                            </div>                                
                                        </div>
                              <!-- 코스 종류 사진 끝 -->   

												
									</div>
								</div>
							</div>
							<!-- 포스트 끝 -->
							
							<!--  댓글 시작 -->
                            <div class="comments-area">
                                <div class="title-g margin-30px-bottom">
                                    <h3>댓글</h3>
                                </div>
                                <div class="comment-box">
                                    <div class="author-thumb">
                                        <img src="img/blog/01.png" class="rounded-circle width-85 xs-width-100" alt="" />
                                    </div>
                                    <div class="comment-info">
                                        <h6><a href="javascript:void(0);">Alex Joyrina</a></h6>
                                        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                                        <div class="reply">
                                            <a href="javascript:void(0);">
                                                <i class="fa fa-reply" aria-hidden="true"></i> Reply
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="comment-box">
                                    <div class="author-thumb">
                                        <img src="img/blog/02.png" alt="" class="rounded-circle width-85 xs-width-100" />
                                    </div>
                                    <div class="comment-info">
                                        <h6><a href="javascript:void(0);">Jama Karleny</a></h6>
                                        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                                        <div class="reply">
                                            <a href="javascript:void(0);">
                                                <i class="fa fa-reply" aria-hidden="true"></i> Reply
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="comment-box">
                                    <div class="author-thumb">
                                        <img src="img/blog/03.png" alt="" class="rounded-circle width-85 xs-width-100" />
                                    </div>
                                    <div class="comment-info">
                                        <h6><a href="javascript:void(0);">Ivonne Drennen</a></h6>
                                        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                                        <div class="reply">
                                            <a href="javascript:void(0);">
                                                <i class="fa fa-reply" aria-hidden="true"></i> Reply
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 댓글 끝 -->
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- 여행 코스 상세정보 끝 -->

<!-- 이미지 클릭 시 상세정보 모달창 띄우기 -->
<script type="text/javascript">

</script>


<script>

//좋아요 기능 시작

//회원 좋아요 있는지 여부 확인 
$(document).ready(function(){
	getGreat()
})

var id = $('#id').val();  //id값 들고오기 
var greatNcode = window.location.pathname.split("/").pop(); //상세페이지 번호
var greatFlag = ("LCO");  //course 구분
var $likeBtn = $('.heart'); //하트버튼 id값


var greatVO = {
	    id: id,
	    greatFlag: greatFlag,
	    greatNcode: greatNcode
	};

//회원 좋아요 있는지 여부 확인 
function getGreat(){
$.ajax({
  url: "/greatCheck/"  + greatNcode +"/"+ id,
  data: greatVO
}).then(function(result) { 
  if (result) { // greatCheck 메서드에서 반환된 값이 true/false이므로, result로 바로 사용 가능
    $likeBtn.addClass("active")
    .find("img").attr({
      src: "https://cdn-icons-png.flaticon.com/512/803/803087.png", 
    })
  } else {
    $likeBtn.removeClass("active")
    .find("img").attr({
      src: "https://cdn-icons-png.flaticon.com/512/812/812327.png",
    })
    
  }

});
}

$(function() {
	  $likeBtn.click(function() {
	    if (!$likeBtn.hasClass('active')) {
	      $(this).find('img').attr({
	        'src': 'https://cdn-icons-png.flaticon.com/512/803/803087.png',
	        alt: '좋아요 꽉찬거'
	      });
	      great(); //좋아요 함수 호출 
	    } else {
	      $(this).find('i').removeClass('active');
	      $(this).find('img').attr({
	        'src': 'https://cdn-icons-png.flaticon.com/512/812/812327.png',
	        alt: '좋아요 안한거'
	      });
	      greatDown(); //좋아요 취소 호출 
	    }
	  });
	});



//좋아요 클릭시 효과 
 function great() {
  $.ajax({
    url: "/greatUP/" + greatNcode,
    type: "POST",
    data: greatVO,
    success: function(result) {
      alert(result.message);
      getGreat(); //회원 확인 여부 호출
    },
    error: function() {
      alert("좋아요를 누르는 중 오류가 발생했습니다.");
    }
  });
  console.log(greatVO);
}

//좋아요 취소시 효과 기능 
function greatDown(){
      $.ajax({
        url: "/greatDown/" + greatFlag + "/" + greatNcode + "/" + id,
        type: "POST",
        data: greatVO,
        success: function(result) {
          alert(result.message);
          getGreat(); //회원 확인 여부 호출
        },
        error: function() {
          alert("좋아요 취소 중 오류가 발생했습니다.");
        }
          });
    } 


</script>



	</div>

</body>
</html>