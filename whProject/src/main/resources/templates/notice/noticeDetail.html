<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/index}">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css?aa">
<body>
	<!-- 내용 시작 -->
	<div layout:fragment="content" class="content">
		<!--좋아요 버튼 css-->
<style>
a {
	text-decoration: none;
	color: inherit;
	cursor: pointer;
}

.right_area .icon {
	display: flex;
	align-items: center;
	justify-content: center;
	width: calc(100vw * ( 45/ 1920));
	height: calc(100vw * ( 45/ 1920));
	border-radius: 50%;
	border: solid 2px #eaeaea;
	background-color: #fff;
}

.icon.heart img {
	width: calc(100vw * ( 24/ 1920));
	height: calc(100vw * ( 24/ 1920));
}

.icon.heart.fas {
	color: red
}

.heart {
	transform-origin: center;
}

.heart.active img {
	animation: animateHeart .3s linear forwards;
}

@keyframes animateHeart { 0%{
	transform: scale(.2);
}
40%
{
transform:scale(1.2);
}
100%
{
transform:scale(1);
}
}
</style>
		<!--좋아요 버튼 css-종료-->

		<!-- 배너시작 -->
		<section class="page-title-section bg-img cover-background"
			th:style="|background: url('/img/banner/bg2.jpg')|">
			<h1 class="text-white font-weight-600">공지사항</h1>
			<ul>
				<li><a href="index.html">Home</a></li>
				<li><span class="active">공지사항</span></li>
			</ul>
		</section>
		<!-- 배너끝 -->

		<!-- 내용 찐시 -->
		<form method="post" action="/noticeDelete">
			<br> <br>
			<div class="container">
				<a href="/notice" class="btn btn-primary">목록</a>
				<br>
				<!--좋아요 버튼 기능html-->
				
				<div class="right_area" id="greatBtn">
					<button  type="button" class="icon heart"> 
					<img src="https://cdn-icons-png.flaticon.com/512/812/812327.png"
						id="greatImg">
					</button>
				</div>
				
					<!--좋아요 버튼 기능html 종료-->
				<table class="table">				
					<tr>
						<td width="20%" class="text-center warning">번호</td>
						<td width=30% class="text-center" th:text="${n.noticeCode}"></td>
						<td width="20%" class="text-center warning">작성일</td>
						<td width=30% class="text-center" th:text="${n.noticeRegDate}"></td>
					</tr>
					<tr>
						<th width=20% class="text-center warning">조회수</th>
						<!-- 눈모양 이모티콘 (조회수) -->
						<td width=30% class="text-center" th:text="${n.noticeHit}"></td>
						<td width=20% class="text-center warning">수정일</td>
						<td width=30% class="text-center" th:text="${n.noticeModDate}"></td>
					<tr>
						<th width=20% class="text-center warning">제목</th>
						<td colspan="3" th:text="${n.noticeTitle}"></td>
					</tr>
					<tr>
						<td colspan="4" class="text-left" valign="top" height="200">
							<pre th:utext="${n.noticeContent}"
								style="white-space: pre-wrap; border: none; background-color: white;"> </pre>
						</td>
					<tr>
						<th width=20% class="text-center warning">파일</th>
						<td colspan="3" th:text="${n.imgName}"></td>
					</tr>
					<br>

					<tr>
						<td><a
							th:href="|/noticeUpdateForm?noticeCode=${n.noticeCode}|"
							class="btn btn-primary">수정</a>&nbsp;&nbsp;&nbsp; <input
							type="hidden" name="noticeCode" th:value="${n.noticeCode}" />
							<button type="submit" class="btn btn-danger">삭제</button></td>
				</table>

			</div>
				<script>
				//heart 좋아요 클릭시! 하트 뿅
				var greatNcode = window.location.pathname.split("/").pop();
				var userId = sessionStorage.getItem("id");
				greatCheck(greatNcode,"user1");
				console.log(greatNcode);
				console.log(userId);
				$(function() {
					var $likeBtn = $('.heart');

					$likeBtn.click(function() {			

								if (!$likeBtn.hasClass('active')) {
									$(this).find('img').attr(
													{
														'src' : 'https://cdn-icons-png.flaticon.com/512/803/803087.png',
														alt : '좋아요 꽉찬거 '														
													})

									great();
									
								} else {
									$(this).find('i').removeClass('active');//.addClass('far')
									$(this).find('img').attr(
													{
														'src' : 'https://cdn-icons-png.flaticon.com/512/812/812327.png',
														alt : "좋아요 안한거"
														
													})
								
								greatDown();
								}
							})
				})
			
				function greatCheck(greatNcode, userId) {
					  var $likeBtn = $('.icon.heart');

					  $.ajax({
					    url: "/greatCheck/" + greatNcode + "/" + userId,
					  }).then(function(result) {	
						  //값이 있으면 찐하트 
					    if (result.isLiked) {
					      $likeBtn.addClass("active")
					        .find("img").attr({
					          src: "https://cdn-icons-png.flaticon.com/512/803/803087.png", 
					      
					        })
					        //값이 없으변 빈하트 
					    } else {
					      $likeBtn.removeClass("active")
					        .find("img").attr({
					          src: "https://cdn-icons-png.flaticon.com/512/812/812327.png",
					   
					        })
					    }
					  });
					}


				
				function great() {
					
					
					
					
					$.ajax({
						url : "/greatUp/" + greatNcode,
						type : "POST",
						success : function(result) {
							alert(result.message);
						},
						error : function() {
							alert("좋아요를 누르는 중 오류가 발생했습니다.");
						}
					});
				}
				
				function greatDown(){
					

				    
				      $.ajax({
				        url: "/greatDown/" + greatNcode,
				        type: "POST",
				        success: function(result) {
				          alert(result.message);
				        },
				        error: function() {
				          alert("좋아요 취소 중 오류가 발생했습니다.");
				        }
				      
				          
				          });
				    }
				  

				  
				
				</script>

		</form>

	</div>


	<!-- 관리자시 권한 주는것 
						<div
							th:if="${#session.getAttribute('member') != null and #session.getAttribute('member').admin}">
							<a th:href="@{/noticeUpdateForm(noticeCode=${n.noticeCode})}"
								class="btn btn-primary">수정</a>&nbsp;&nbsp;&nbsp; <a
								th:href="@{/noticeDelete(noticeCode=${n.noticeCode})}"
								class="btn btn-danger" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</a>
						</div>
						
	 내용 끝 -->
</body>
</html>